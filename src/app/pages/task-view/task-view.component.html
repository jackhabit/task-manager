<div class="centered-content">
  <div class="task-manager-container">
    <div class="sidebar">
      <h1 class="title has-text-primary">Lists</h1>
      <div class="list-menu">
        <a
          class="list-menu-item"
          *ngFor="let list of lists(); let i = index"
          [class.is-active]="selectedListIndex() === i"
          (click)="selectList(i)"
          style="
            display: flex;
            align-items: center;
            justify-content: space-between;
          "
        >
          <p style="margin: 0">{{ list.title }}</p>
          <button
            class="delete is-small"
            (click)="removeList(i); $event.stopPropagation()"
            title="Remove list"
            style="margin-left: 8px"
          ></button>
        </a>
      </div>
      <button class="button is-primary has-text-white" routerLink="/new-item">
        + New List
      </button>
    </div>
    <div class="task-list-container has-background-light">
      <h1 class="title has-text-primary">Tasks</h1>
      <div *ngIf="selectedListIndex() === null">
        <p>Select a list to view tasks.</p>
      </div>
      <div *ngIf="selectedListIndex() !== null" style="margin-bottom: 16px">
        <button
          class="button is-primary has-text-white"
          (click)="showAddTask.set(!showAddTask())"
          style="margin-bottom: 8px; margin-top: 20px"
        >
          + Add Task to "{{ lists()[selectedListIndex()!].title }}"
        </button>
        <div *ngIf="showAddTask()">
          <input
            type="text"
            class="input has-background-light is-medium has-text-black"
            placeholder="Task description"
            [ngModel]="newTaskText()"
            (ngModelChange)="newTaskText.set($event)"
            (keydown.enter)="addTaskToSelectedList()"
            style="width: 70%; display: inline-block"
          />
          <button
            class="button is-success is-primary has-text-white is-medium"
            (click)="addTaskToSelectedList()"
          >
            Add
          </button>
        </div>
        <div
          *ngFor="
            let task of lists()[selectedListIndex()!]?.tasks;
            let ti = index;
            trackBy: trackByTask
          "
          class="task"
        >
          <p style="display: inline-block; margin: 0; color: black">
            {{ task.todo }}
          </p>
          <button
            class="delete is-small"
            style="float: right; margin-left: 10px"
            (click)="removeTaskFromSelectedList(ti); $event.stopPropagation()"
            title="Remove task"
          ></button>
        </div>
      </div>
    </div>
  </div>
</div>
